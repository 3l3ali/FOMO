<% content_for(:title) do %>
  <%= @post.title %> | Missing Out
<% end %>
<% content_for(:after_js) do %>
  <script>
    $(document).omSlider({
      slider: $('.slider'),
      dots: $('.dots'),
      next:$('.btn-right'),
      pre:$('.btn-left'),
    });
  </script>
<% end %>
<div class="show-container">
    <div class="banner">
      <div class="slider">
        <ul>
          <% @post.photos.each do |photo| %>
            <li>
            <div class="show-photo">
              <%= cl_image_tag(photo.path)%>
            </div>
            </li>
          <% end %>
        </ul>
        <div class="dots"> <a href="javascript:void(0);" rel="0" class="cur"></a> <a href="javascript:void(0);" rel="1"></a> <a href="javascript:void(0);" rel="2"></a> <a href="javascript:void(0);" rel="3"></a> </div>
        <div class="arrow"> <a href="javascript:void(0);" class="btn-left">&lt;</a> <a href="javascript:void(0);" class="btn-right">&gt;</a> </div>
      </div>
    </div>
  <div class="container">
    <div class="row">
      <div class="col-xs-12 hidden-md hidden-lg hidden-xl">
        <div class="show-box">
          <div class="show-title">
            <h2><%= @post.title %></h2>
            <p><%= @post.location.address %></p>
          </div>
          <div class="get-direction">
            <a href="#" class="btn btn-primary">Get Directions</a>

            <%= link_to edit_post_path(@post), class: "pen-update" do %>
              <i class="fa fa-pencil" aria-hidden="true"></i>
            <% end if policy(@post).update? %>

            <%= link_to post_path(@post), method: :delete, data: {confirm: "Are you sure ?"}, class: "trash-delete"  do %>
              <i class="fa fa-trash" aria-hidden="true"></i>
            <% end if policy(@post).destroy? %>

          </div>
        </div>
        <div class="clear"></div>
        <div class="show-info">
          <p><strong>Hours of Operation:</strong> Monday - Friday 9AM - 5PM</p>
          <p><strong>Contact:</strong>  www.sake.co.jp | +81 75-771-0246</p>
        </div>
        <div class="place-review">
          <p><%= @post.description %></p>
        </div>

        <% if current_user %>
          <div>
            <% unless current_user.favourites.where(post: @post).exists?  %>
              <%= link_to favourites_add_path(post_id: @post.id), class: "empty-heart" do %>
                <i class="fa fa-heart-o" aria-hidden="true"></i>
              <% end %>
            <% else %>
              <%= link_to favourites_remove_path(post_id: @post.id), class: "filled-heart" do %>
                <i class="fa fa-heart" aria-hidden="true"></i>
              <% end %>
            <% end %>
          </div>
        <% else %>
          <div>
            <%= link_to new_user_session_path, class: "empty-heart" do %>
              <i class="fa fa-heart-o" aria-hidden="true"></i>
            <% end %>
          </div>
        <% end %>
      </div>
      <div class="col-xs-12 hidden-md hidden-lg hidden-xl">
        <div class="review-header">
          <div class="review-title">
            <h4>Reviews:</h4>
          </div>
          <% if user_signed_in? %>
            <div id="addReview" class="btn btn-primary">Add a review</div>
          <% else %>
            <%= link_to "Add a review", new_user_session_path, class: "btn btn-primary" %>
          <% end %>
        </div>
        <div id="reviewForm">
          <%= render 'reviews/form', post: @post, review: @review %>
        </div>
        <ul id="myReviews" class="my-reviews">
          <li>
            <div id="reviews">
              <% @post.reviews.reverse.each do |review| %>
                <%= render 'review' , review: review %>
              <% end %>
            </div>
          </li>
        </ul>
      </div>
      <% if @post.reviews.count > 3 %>
        <div id="loadMore" class="text-center">Load more</div>
      <% end %>
    </div>
  </div>


  <div class="desktop-show  hidden-sm hidden-xs">
    <div class="desktop-show-info">
      <div class="desktop-show-title">
        <h2><%= @post.title %></h2>
        <p><%= @post.location.address %></p>
      </div>
      <div class="desktop-get-direction">
        <a href="#" class="btn btn-primary">Get Directions</a>

        <%= link_to edit_post_path(@post), class: "pen-update" do %>
          <i class="fa fa-pencil" aria-hidden="true"></i>
        <% end if policy(@post).update? %>

        <%= link_to post_path(@post), method: :delete, data: {confirm: "Are you sure ?"}, class: "trash-delete" do %>
          <i class="fa fa-trash" aria-hidden="true"></i>
        <% end if policy(@post).destroy? %>
      </div>

      <% if current_user %>
        <div>
          <% unless current_user.favourites.where(post: @post).exists?  %>
            <%= link_to favourites_add_path(post_id: @post.id), class: "empty-heart" do %>
              <i class="fa fa-heart-o" aria-hidden="true"></i>
            <% end %>
          <% else %>
            <%= link_to favourites_remove_path(post_id: @post.id), class: "filled-heart" do %>
              <i class="fa fa-heart" aria-hidden="true"></i>
            <% end %>
          <% end %>
        </div>
      <% else %>
        <div>
          <%= link_to new_user_session_path, class: "empty-heart" do %>
            <i class="fa fa-heart-o" aria-hidden="true"></i>
          <% end %>
        </div>
      <% end %>
    </div>
    <div class="desktop-show-map">
      <div id="map"></div>
      <!-- Include Google Maps JS library. You should use your *own* key -->
      <script src="https://maps.google.com/maps/api/js?key=<%= ENV['GOOGLE_API_BROWSER_KEY'] %>"></script>
      <%= content_for(:after_js) do %>
          <script type="text/javascript">
            $(document).on('ready', function() {
              var handler = Gmaps.build('Google', { markers: { clusterer: undefined }});
              handler.buildMap({ internal: { id: 'map' } }, function(){
                markers = handler.addMarkers([
                  {
                    "lat": <%= @post.location.latitude %>,
                    "lng": <%= @post.location.longitude %>,
                    "infowindow": "<h1>Aix - Marseille</h1>"
                  }
                ]);
                handler.bounds.extendWith(markers);
                handler.fitMapToBounds();
              });
            })
          </script>
      <% end %>
    </div>
    <div class="desktop-show-review">
      <div class="review-header">
          <div class="review-title">
            <h4>Reviews:</h4>
          </div>
          <% if user_signed_in? %>
            <div id="addReview" class="btn btn-primary">Add a review</div>
          <% else %>
            <%= link_to "Add a review", new_user_session_path, class: "btn btn-primary" %>
          <% end %>
        </div>
        <div id="reviewForm">
          <%= render 'reviews/form', post: @post, review: @review %>
        </div>
        <ul id="myReviews" class="my-reviews">
          <li>
            <div id="reviews">
              <% @post.reviews.reverse.each do |review| %>
                <%= render 'review' , review: review %>
              <% end %>
            </div>
          </li>
        </ul>
    </div>

    <div class="desktop-show-location">
    </div>

  </div>
</div>
